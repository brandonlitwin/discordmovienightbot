# Discord Movie Night Bot
Have you and your Discord buddies ever wanted to watch movies together, and keep track of what you have and have not watched? This is the Discord bot for you! Inspired by [this](https://github.com/navi1995/Movie-Night-Discord-Bot), but with role restrictions removed and some new features added for user convenience. The framework used was `Discord.py`, which you can read about [here](https://discordpy.readthedocs.io/en/latest/).

## How to Install
This guide will outline the steps needed to run this bot on your local machine for use in your own Discord server.
1. Clone this repo.
1. Have [MongoDB](https://treehouse.github.io/installation-guides/windows/mongo-windows.html) installed on your local machine.
1. Activate a Python 3 virtual env in your directory (not required but recommended).
1. Install all Python dependencies with `pip install -r requirements.txt`.
1. For first time setup, run `python create_db.py` to initialize the database. Make sure to have your Mongo client running first.
1. [Register your bot](https://discordpy.readthedocs.io/en/latest/discord.html) through Discord and get a Discord token.
1. Get an [OMDb API key](http://www.omdbapi.com/apikey.aspx)
1. Create a `.env` file in your repo clone containing the following items:
   1. DISCORD_TOKEN={the token from step 6} 
   1. OMDB_API_KEY={the key from step 7}
   1. CHANNEL_ID={the [ID](https://support.discord.com/hc/en-us/articles/206346498-Where-can-I-find-my-User-Server-Message-ID-) of the Discord channel you want to use the bot}
   1. SERVER_ID={the [ID](https://support.discord.com/hc/en-us/articles/206346498-Where-can-I-find-my-User-Server-Message-ID-) of the Discord server you want to use the bot}
1. Run `python bot.py` and you should be good to go!

## Command Prefix
The command prefix is the symbol before a command in a Discord message that will signify to the bot that it should read that message as a command. The default prefix is `--` but this can be modified directly in `bot.py` line 23.

## Command List
At any time, you can type the **help** command in your Discord channel with the bot running to display these commands.

**add** - Add movie to the watch list. IMDB link or title accepted.

**bulkadd** - Add group of movies. IMDB links or titles accepted.

**get** - Print a list of current unwatched movies.

**getviewed** - Print a list of current watched movies. If `autoview` is on, movies will automatically be placed here after they are chosen in the poll.

**poll** - Select 10 random movies and create a poll. Default time is 1440 min (24 hours). In the case of a tie of votes, the poll will create a tiebreaker between the tied movies. The default tiebreak poll length is 5 minutes (300 seconds), which can be modified in `config.py` - `tiebreak_num_seconds`. If this leads to another tie, the bot will select a random movie of the tied movies.

**remove** - Remove from watch list. IMDB links or titles accepted.

**schedule** - Schedule the autopoll, which will take a datetime and automatically start a poll at that time in your channel. Ex: `Monday 12pm` will schedule a poll for next Monday at noon. Every time the bot is turned off, the autopoll will have to be rescheduled, as it will be set to its default value of '2000-01-01 12:00:00' which is also configurable in `config.py`.

**setviewed** - Put movie in viewed list. IMDB link or title accepted. Basically the manual version of `autoview`.

**toggleautoview** - Toggle autoview of movies after poll is done. Default value is `True`, which can be modified in `config.py`

**vote** - Cast your votes in order from first to third pick. Use the number labels generated by the poll. Can choose to pick only one, two, or three movies. You can only vote once per poll.
